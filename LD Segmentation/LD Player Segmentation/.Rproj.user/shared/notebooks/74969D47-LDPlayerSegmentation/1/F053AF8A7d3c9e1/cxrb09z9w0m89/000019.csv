"0","ld_per_player <- ld_cleaned |>"
"0","  group_by(Playerid,`Activity Month`) |>"
"0","  reframe("
"0","         Month_Bet_Count = sum(`Bet Count`),"
"0","         Month_AVG_Turnover_USD = sum(`Turnover Usd`)/Month_Bet_Count,"
"0","         Month_AVG_GGR_USD = sum(`Ggr Usd`)/Month_Bet_Count,"
"0","         LT_Bet_Count = sum(LT_Bet_Count),"
"0","         LT_AVG_Turnover_USD = sum(LT_Turnover_USD)/sum(LT_Bet_Count),"
"0","         LT_AVG_GGR_USD = sum(LT_GGR_USD)/sum(LT_Bet_Count)) |>"
"0","  ungroup() |>"
"0","  mutate("
"0","       Month_Bet_Count_scale = r.zscore(Month_Bet_Count),"
"0","       Month_AVG_Turnover_USD_scale = r.zscore(Month_AVG_Turnover_USD),"
"0","       Month_AVG_GGR_USD_scale = r.zscore(Month_AVG_GGR_USD),"
"0","       LT_Bet_Count_scale = r.zscore(LT_Bet_Count),"
"0","       LT_AVG_Turnover_USD_scale = r.zscore(LT_AVG_Turnover_USD),"
"0","       LT_AVG_GGR_USD_scale = r.zscore(LT_AVG_GGR_USD))"
"0",""
"0",""
"0","ld_per_player <- ld_per_player |>"
"0","   mutate("
"0","       Month_Bet_Count_score = scoring(Month_Bet_Count_scale),"
"0","       Month_Turnover_USD_score = scoring(Month_AVG_Turnover_USD_scale),"
"0","       Month_GGR_USD_score = scoring(Month_AVG_GGR_USD_scale),"
"0","       Month_Overall_score = Month_GGR_USD_score*100+Month_Turnover_USD_score*10+Month_Bet_Count_score,"
"0","       LT_Bet_Count_score = scoring(LT_Bet_Count_scale),"
"0","       LT_Turnover_USD_score = scoring(LT_AVG_Turnover_USD_scale),"
"0","       LT_GGR_USD_score = scoring(LT_AVG_GGR_USD_scale),"
"0","       LT_Overall_score = LT_GGR_USD_score*100+LT_Turnover_USD_score*10+LT_Bet_Count_score)"
"0",""
"0","ld_per_player <- ld_per_player |>"
"0","  mutate(Overall.Month.segment = segments(Month_Overall_score),"
"0","         Overall.LT.segment = segments(LT_Overall_score))"
