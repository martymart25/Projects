"0",""
"0","con <- odbcConnect(dsn = ""DA"","
"0","                   uid = key_get(""db_user""),"
"0","                   pwd = key_get(""db_pass""))"
"0",""
"0","ld_df_raw <- sqlQuery(con,"""
"0","                      SELECT *"
"0","                      FROM ref_db.ray.ld_players_data "
"0","                        "")"
"2","Registered S3 methods overwritten by 'htmltools':
  method               from         
  print.html           tools:rstudio
  print.shiny.tag      tools:rstudio
  print.shiny.tag.list tools:rstudio
"
"0","  "
"0",""
"0",""
"0",""
"0","ld_df <- ld_df_raw "
"0",""
"0",""
"0","## Data Cleaning"
"0","ld_df[ld_df$`Turnover Usd` == 0 & ld_df$`Ggr Usd` == 0 &"
"0","        ld_df$`Bet Count` == 0,] <- NA"
"0",""
"0","ld_cleaned <- ld_df |>"
"0","  drop_na()"
"0",""
"0",""
"0","scoring <- function(x) {"
"0","  res <- as.integer()"
"0","  for(i in 1:length(x)) {"
"0","    if(x[i] >= 3.5) {"
"0","     res[i] <- 4"
"0","    } "
"0","    else if (x[i] >= 0 & x[i] < 3.5){"
"0","      res[i] <- 3"
"0","    }"
"0","    else if (x[i] > -3.5 & x[i] < 0){"
"0","      res[i] <- 2"
"0","    }"
"0","    else if (x[i] <= -3.5) {"
"0","      res[i] <- 1"
"0","    }"
"0","    else{res[i] <- 0}"
"0","    "
"0","  }"
"0","  res"
"0","  "
"0","}"
"0",""
"0",""
"0","segments <- function(x) {"
"0","  res <- c()"
"0","    profitable_outliers <- c(4444, 4443, 4434, 4433, 4344, 4343, 4334, 4333)"
"0","  "
"0","  profitable <- c(4442, 4432, 4424, 4423, 4422, 4342, 4332, 4324, 4323, 4322, 4234, 4233, 4224, 4223, 4222, 3442, 3432, 3424, 3423, 3422, 3342, 3333, 3332, 3324, 3323, 3322, 3244, 3243, 3242, 3234, 3233, 3232, 3224, 3223, 3222,3444, 3443, 3434, 3433, 3344, 3343, 3334)"
"0","  "
"0","  grinders <- c(2444, 2443, 2442, 2434, 2433, 2432, 2424, 2423, 2422, 2344, 2343, 2342, 2334, 2333, 2332, 2324, 2323, 2322, 2244, 2243, 2242, 2234, 2233, 2232, 2224, 2223, 2222)"
"0","  "
"0","  grinder_outliers <- c(1444, 1443, 1442, 1434, 1433, 1432, 1424, 1423, 1422, 1344, 1343, 1342, 1334, 1333, 1332, 1324, 1323, 1322, 1234, 1233, 1232, 1223, 1222, 1221, 1211, 1111, 1122, 1112, 1121)"
"0","  for(i in 1:length(x)) {"
"0","    if (x[i] %in% profitable_outliers) {"
"0","      res[i] <- ""Profitable Outlier"""
"0","    }"
"0","    else if (x[i] %in% profitable) {"
"0","      res[i] <- ""Profitable"""
"0","    }"
"0","    else if (x[i] %in% grinders) {"
"0","      res[i] <- ""Grinder"""
"0","    }"
"0","    else if (x[i] %in% grinder_outliers) {"
"0","      res[i] <- ""Grinder Outlier"""
"0","    } else {NULL}"
"0","    "
"0","  }"
"0","  res"
"0","  "
"0",""
"0","}"
"0",""
"0",""
"0",""
